INSERT INTO CONVENIO VALUES ('12345678901234', 'Convenio Hapvida', '10%');

INSERT INTO CONVENIO VALUES ('98765432109876', 'Convenio Unimed', '15%');

INSERT INTO CONVENIO VALUES ('45678901234567', 'Convenio Saúde e amor', '20%');

INSERT INTO PACIENTE VALUES ('11122233333', 'Roberto',  TO_DATE('15/05/1990', 'DD/MM/YYYY'), 34, 'Rua Mangabeira', 'Recife', '123', 'Macaxeira', '984155152', 'allysonryan.ares@gmail.com', '45678901234567');

INSERT INTO PACIENTE VALUES ('22233344428', 'Paula', TO_DATE('20/10/1985', 'DD/MM/YYYY'), 39, 'Rua Guanabara', 'Jaboatão', '456', 'Areias', '984155662', 'paula.lucena@outlook.com', NULL);

INSERT INTO PACIENTE VALUES ('33344455577', 'Gustavo', TO_DATE('10/03/2000', 'DD/MM/YYYY'), 24, 'Rua Jenipapo', 'Paulista', '789', 'Largo', '994252152', '987664312', '98765432109876');

INSERT INTO PACIENTE VALUES ('44455566600', 'Luis', TO_DATE('25/07/1982', 'DD/MM/YYYY'), 42, NULL, NULL, NULL, NULL, NULL, NULL, '12345678901234');

INSERT INTO PACIENTE VALUES ('55566677794', 'Miguel', TO_DATE('12/12/1975', 'DD/MM/YYYY'), 49, 'Rua Jiló', 'Recife', '10', 'Werneck', '994327621', 'miguelg@yahoo.com.br', '98765432109876');

INSERT INTO PACIENTE VALUES ('66677788843', 'Júlia', NULL, 33, 'Rua Aipim', 'Paulista', '30', 'Areias', '987775432', '@julia_lim4', '45678901234567');

INSERT INTO DENTISTA VALUES ('44455566677', 'Alberto', TO_DATE('25/07/1982', 'DD/MM/YYYY'), 42, 'Ortodontia', 'Implantodontia', 'Rua Jiló', 'Recife', '10', 'Werneck', '994322345', '30012444');

INSERT INTO DENTISTA VALUES ('55566677788', 'Rosangela', TO_DATE('12/12/1975', 'DD/MM/YYYY'), 49, 'Endodontia', NULL, 'Rua Caqui', 'Jaboatão', '20', 'Macaxeira', '994300120', '988435762');

INSERT INTO DENTISTA VALUES ('66677788899', 'Ivan', TO_DATE('30/04/1988', 'DD/MM/YYYY'), 36, 'Periodontia', 'Ortodontia', 'Rua Aipim', 'Paulista', '30', 'Areias', '99662482', NULL);

INSERT INTO DENTISTA VALUES ('77788899900', 'Ricardo',TO_DATE('01/01/1970', 'DD/MM/YYYY'), 54, 'Ortodontia', 'Implantodontia', NULL, NULL, NULL, NULL, 'ricardoutor@gmail.com', '@dr.ricardo');

INSERT INTO FUNCIONARIO VALUES ('14755341400', 'Celso', TO_DATE('01/01/1970', 'DD/MM/YYYY'), 54, 'Rua Pitaya', 'Igarassu', '100', 'Forte Orange', NULL, '98664323');

INSERT INTO FUNCIONARIO VALUES ('88899900011', 'Júlio', NULL, 41, 'Rua Tangerina', 'Paudalho', NULL, 'Primavera', '981242156', '987654432');

INSERT INTO FUNCIONARIO VALUES ('99900011122', 'Angela', TO_DATE('05/09/1995', 'DD/MM/YYYY'), 29, 'Rua Caqui', 'Camaragibe', '300', 'Centro', '982747632', '987654222');

INSERT INTO CHEFIA VALUES ('14755341400', '88899900011');

INSERT INTO CHEFIA VALUES ('88899900011', '99900011122');

INSERT INTO CHEFIA VALUES ('14755341400', '99900011122');

INSERT INTO PIS VALUES ('12345678901', '14755341400');

INSERT INTO PIS VALUES ('23456789012', '88899900011');

INSERT INTO PIS VALUES ('34567890123', '99900011122');

INSERT INTO BENEFICIOS VALUES ('Plano de Saúde', '12345678901');

INSERT INTO BENEFICIOS VALUES ('Vale Alimentação', '23456789012');

INSERT INTO BENEFICIOS VALUES ('Vale Transporte', '34567890123');

INSERT INTO CONSULTORIO VALUES ('12345678', 'Rua cortez, 100', 'Olinda', 'Sorridents');

INSERT INTO CONSULTORIO VALUES ('23456789', 'Avenida norte, 200', 'Recife', 'Dentin');

INSERT INTO CONSULTORIO VALUES ('34567890', 'Praça dos campos, 300', 'Caruaru', 'Bom Dente');

INSERT INTO SERVICO VALUES ('12345678', 'Rua cortez, 100', '14755341400', TO_DATE('01/01/2020', 'DD/MM/YYYY'), NULL, 'Recepcionista');

INSERT INTO SERVICO VALUES ('23456789', 'Avenida norte, 200', '88899900011', NULL,'Segunda a Sábado, 09:00 - 19:00', 'Atendente');

INSERT INTO SERVICO VALUES ('34567890', 'Praça dos campos, 300', '99900011122', TO_DATE('15/03/2021', 'DD/MM/YYYY'), 'Segunda e Quinta, 10:00 - 20:00', 'Auxiliar Administrativo');

INSERT INTO SALA VALUES ('12345678', 'Rua cortez, 100', '1');

INSERT INTO SALA VALUES ('23456789', 'Avenida norte, 200', '2');

INSERT INTO SALA VALUES ('34567890', 'Praça dos campos, 300', '3');

INSERT INTO SALA VALUES ('12345678', 'Rua cortez, 100', '2');

INSERT INTO SALA VALUES ('12345678', 'Rua cortez, 100', '3');

INSERT INTO CRO VALUES ('RS123456', 'RS', '44455566677');

INSERT INTO CRO VALUES ('SP654321', 'SP', '55566677788');

INSERT INTO CRO VALUES ('MG987654', 'MG', '66677788899');

INSERT INTO CONSULTA VALUES ('12345678', 'Rua cortez, 100', '1', '11122233333', '44455566677', TO_TIMESTAMP('15/01/2023 10:30:00', 'DD/MM/YYYY HH24:MI:SS'), 100.00, 'Rotina');

INSERT INTO CONSULTA VALUES ('23456789', 'Avenida norte, 200', '2', '22233344428', '55566677788', TO_TIMESTAMP('20/02/2023 08:30:00', 'DD/MM/YYYY HH24:MI:SS'), 150.00, 'Emergência');

INSERT INTO CONSULTA VALUES ('34567890', 'Praça dos campos, 300', '3', '33344455577', '66677788899', TO_TIMESTAMP('25/03/2023 10:20:00', 'DD/MM/YYYY HH24:MI:SS'), 120.00, NULL);

INSERT INTO CONSULTA VALUES ('34567890', 'Praça dos campos, 300', '3', '44455566600', '66677788899', TO_TIMESTAMP('25/03/2023 10:50:00', 'DD/MM/YYYY HH24:MI:SS'), NULL, 'Check-up');

INSERT INTO DOCUMENTO VALUES ('RS123456', TO_TIMESTAMP('15/01/2023 10:30:00', 'DD/MM/YYYY HH24:MI:SS'),TO_TIMESTAMP('15/01/2023 10:30:00', 'DD/MM/YYYY HH24:MI:SS'), 'Extração dentária', '12345678', 'Rua cortez, 100', '1', '11122233333', '44455566677');

INSERT INTO DOCUMENTO VALUES ('SP654321', TO_TIMESTAMP('20/02/2023 09:00:00', 'DD/MM/YYYY HH24:MI:SS'), TO_TIMESTAMP('20/02/2023 08:30:00', 'DD/MM/YYYY HH24:MI:SS'),'Cárie em metade dos dentes', '23456789', 'Avenida norte, 200', '2', '22233344428', '55566677788');

INSERT INTO DOCUMENTO VALUES ('RS123456', TO_TIMESTAMP('15/01/2023 10:40:00', 'DD/MM/YYYY HH24:MI:SS'), TO_TIMESTAMP('15/01/2023 10:30:00', 'DD/MM/YYYY HH24:MI:SS'),'Apenas um dente na boca, preocupante', '12345678', 'Rua cortez, 100', '1', '11122233333', '44455566677');

INSERT INTO MEDICAMENTO VALUES ('1234567890123', '10mg', 'Comprimido', 'Diclac');

INSERT INTO MEDICAMENTO VALUES ('2345678901234', '5mL', 'Solução', 'Probenxil ');

INSERT INTO MEDICAMENTO VALUES ('3456789012345', '200mg', 'Cápsula', 'Neotaren ');

INSERT INTO ATENDIMENTO_DENTISTA VALUES ('12345678', 'Rua cortez, 100', '44455566677', '08:00 - 18:00');

INSERT INTO ATENDIMENTO_DENTISTA VALUES ('23456789', 'Avenida norte, 200', '55566677788', '09:00 - 19:00');

INSERT INTO ATENDIMENTO_DENTISTA VALUES ('34567890', 'Praça dos campos, 300', '66677788899', '10:00 - 20:00');

INSERT INTO ACEITA_CONVENIO VALUES ('44455566677', '12345678901234');

INSERT INTO ACEITA_CONVENIO VALUES ('55566677788', '98765432109876');

INSERT INTO ACEITA_CONVENIO VALUES ('66677788899', '45678901234567');

INSERT INTO ACEITA_CONVENIO VALUES ('44455566677', '45678901234567');

INSERT INTO CONTROLE_PRESCRICAO VALUES ('RS123456', TO_TIMESTAMP('15/01/2023 10:30:00', 'DD/MM/YYYY HH24:MI:SS'), '1234567890123');

INSERT INTO CONTROLE_PRESCRICAO VALUES ('SP654321', TO_TIMESTAMP('20/02/2023 09:00:00', 'DD/MM/YYYY HH24:MI:SS'), '2345678901234');

SELECT D.NOME 
FROM DENTISTA D 
WHERE D.CPF IN (SELECT C.CPF_DENTISTA 
FROM CRO C 
WHERE C.CPF_DENTISTA = D.CPF  
AND C.REGISTRO IN (SELECT P.REGISTRO 
FROM CONTROLE_PRESCRICAO P 
GROUP BY P.REGISTRO 
HAVING COUNT(*) > 1 
));

SELECT D.NOME, D.CPF, C.NOME 
FROM DENTISTA D, ATENDIMENTO_DENTISTA A, CONSULTORIO C 
WHERE (D.CPF = A.CPF) 
AND (A.CEP=C.CEP);

SELECT F.NOME, F.CPF, C.NOME 
FROM FUNCIONARIO F, SERVICO S, CONSULTORIO C 
WHERE (F.CPF = S.CPF) 
AND (S.CEP=C.CEP);

SELECT D.NOME AS DENTISTA, F.NOME AS FUNCIONÁRIO, CONCAT(CONCAT(C.ENDERECO, ', '), C.NOME) AS CONSULTÓRIO  
FROM CONSULTORIO C INNER JOIN ATENDIMENTO_DENTISTA A ON (C.CEP = A.CEP) INNER JOIN DENTISTA D ON (D.CPF = A.CPF), FUNCIONARIO F, SERVICO S 
WHERE (S.CEP = A.CEP) AND (S.CPF = F.CPF);

SELECT D.NOME, D.ESPECIALIZACAO1, D.ESPECIALIZACAO2 
FROM DENTISTA D 
WHERE D.ESPECIALIZACAO1 IS NOT NULL AND D.ESPECIALIZACAO2 IS NOT NULL;

SELECT D.NOME, D.ESPECIALIZACAO1, D.ESPECIALIZACAO2 
FROM DENTISTA D 
ORDER BY ESPECIALIZACAO1, D.ESPECIALIZACAO2;

SELECT D.NOME, C.ENDERECO, C.CIDADE 
FROM ATENDIMENTO_DENTISTA A INNER JOIN DENTISTA D ON (D.CPF=A.CPF) INNER JOIN CONSULTORIO C ON (C.CEP=A.CEP) 
WHERE A.EXPEDIENTE LIKE '08:00%';

SELECT P.END_CIDADE, COUNT(*) AS MORADORES 
FROM PACIENTE P 
WHERE P.END_CIDADE IS NOT NULL  
GROUP BY P.END_CIDADE 
HAVING COUNT(*) BETWEEN 1 AND 3;

SELECT END_CIDADE AS CIDADE, COUNT(*) AS NUMERO_DE_PESSOAS 
FROM ( 
SELECT P.END_CIDADE,P.CPF  
FROM PACIENTE p 
UNION ALL 
SELECT D.END_CIDADE, D.CPF 
FROM DENTISTA D 
UNION ALL 
SELECT F.END_CIDADE, F.CPF 
FROM FUNCIONARIO F 
)  
WHERE END_CIDADE IS NOT NULL 
GROUP BY END_CIDADE 
HAVING COUNT(*) BETWEEN 1 AND 3;

SELECT P.END_CIDADE--, COUNT(*) AS NUMERO_DE_PACIENTES, AVG(IDADE) AS MEDIA_IDADE 
FROM (SELECT P.END_CIDADE, P.IDADE 
FROM PACIENTE P 
WHERE P.IDADE > 20 AND P.END_CIDADE IS NOT NULL) P 
GROUP BY END_CIDADE 
HAVING COUNT(*) >= 2 AND AVG(P.IDADE) > 20;

SELECT P.END_CIDADE, MAX(P.IDADE) AS MAIS_VELHO 
FROM PACIENTE P 
WHERE P.END_CIDADE IS NOT NULL 
GROUP BY P.END_CIDADE;

SELECT P.NOME, P.END_CIDADE, P.IDADE AS MAIS_VELHO 
FROM PACIENTE P 
WHERE (P.END_CIDADE, P.IDADE) IN (SELECT P.END_CIDADE, MAX(IDADE) 
FROM PACIENTE P 
WHERE P.END_CIDADE IS NOT NULL 
GROUP BY P.END_CIDADE 
);

SELECT S.CEP, S.ENDERECO, COUNT(*) AS QTD_SALAS  
FROM SALA S 
GROUP BY S.CEP, S.ENDERECO;

SELECT C.ENDERECO 
FROM CONSULTORIO C 
WHERE EXISTS (SELECT * 
FROM ATENDIMENTO_DENTISTA);

SELECT C.ENDERECO 
FROM CONSULTORIO C 
WHERE NOT EXISTS (SELECT * 
FROM SERVICO);

SELECT D.END_CIDADE AS CIDADE, AVG(D.IDADE) AS IDADE_MÉDIA 
FROM DENTISTA D 
WHERE D.END_CIDADE IS NOT NULL 
GROUP BY D.END_CIDADE;

SELECT D.END_CIDADE, AVG(EXTRACT(YEAR FROM CURRENT_DATE) - EXTRACT(YEAR FROM D.NASCIMENTO)) AS MEDIA_IDADE 
FROM DENTISTA D 
WHERE D.END_CIDADE IS NOT NULL 
GROUP BY D.END_CIDADE;

SELECT * 
FROM PACIENTE P 
WHERE P.CONVENIO IS NULL;

SELECT CONCAT(CONCAT(C.ENDERECO, ', '), C.NOME) AS CONSULTÓRIO  
FROM CONSULTORIO C 
WHERE EXISTS (SELECT * 
FROM CONSULTA CO 
WHERE CO.CEP = C.CEP) 
AND EXISTS (SELECT * 
FROM SERVICO S 
WHERE S.CEP = C.CEP) 
AND EXISTS (SELECT * 
FROM PACIENTE P 
WHERE P.CONVENIO IN(SELECT AC.CNPJ 
FROM ACEITA_CONVENIO AC 
WHERE AC.CPF_DENTISTA IN(SELECT A.CPF 
FROM ATENDIMENTO_DENTISTA A 
WHERE A.CEP = C.CEP)));

SELECT M.NOME 
FROM MEDICAMENTO M 
WHERE M.NMR IN (SELECT PR.REMEDIO 
FROM CONTROLE_PRESCRICAO PR);

SELECT CO.MOMENTO_CONSULTA, CO.ENDERECO, CO.VALOR, P.NOME 
FROM CONSULTA CO, PACIENTE P 
WHERE (CO.CPF_PACIENTE = P.CPF) 
AND CO.VALOR > (SELECT TRUNC(AVG(VALOR), 2) FROM CONSULTA);

SELECT DOC.MOMENTO_CONSULTA, DOC.ENDERECO, P.NOME, D.NOME 
FROM DOCUMENTO DOC, PACIENTE P, DENTISTA D 
WHERE DOC.INSTRUCOES LIKE '%Extração%'  
AND (P.CPF=DOC.CPF_PACIENTE) 
AND (D.CPF=DOC.CPF_DENTISTA);

SELECT P.NOME, C.NOME, CO.MOMENTO_CONSULTA, CV.NOME, CO.VALOR, CO.VALOR - (CO.VALOR * CAST(REPLACE(CV.DESCONTO, '%', '') AS FLOAT) / 100) AS VALOR_COM_DESCONTO 
FROM CONSULTA CO INNER JOIN PACIENTE P ON (CO.CPF_PACIENTE=P.CPF) INNER JOIN CONSULTORIO C ON (C.CEP=CO.CEP) INNER JOIN CONVENIO CV ON(P.CONVENIO=CV.CNPJ) 
WHERE CO.VALOR IS NOT NULL AND P.CONVENIO IS NOT NULL;

SELECT COALESCE(TO_CHAR(C.MOMENTO_CONSULTA), 'Nenhuma consulta registrada') AS CONSULTA,  
COALESCE(TO_CHAR(C.VALOR), 'Valor não estimado/consulta não obtida') AS VALOR,  
P.NOME AS NOME_PACIENTE, COALESCE(CV.DESCONTO, 'Sem desconto') AS DESCONTO_CONVÊNIO 
FROM CONSULTA C FULL OUTER JOIN PACIENTE P ON (C.CPF_PACIENTE = P.CPF) FULL OUTER JOIN CONVENIO CV ON P.CONVENIO = CV.CNPJ;

SELECT D.NOME AS DENTISTA, C.NOME AS CONSULTÓRIO 
FROM DENTISTA D LEFT OUTER JOIN ATENDIMENTO_DENTISTA A ON (A.CPF=D.CPF) LEFT OUTER JOIN CONSULTORIO C ON (A.CEP=C.CEP);

